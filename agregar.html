<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Productos</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        .product-card img {
            max-height: 200px;
            object-fit: cover;
        }

        .product-card {
            transition: transform 0.2s ease-in-out;
        }

        .product-card:hover {
            transform: translateY(-5px);
            box-shadow: 0px 4px 10px rgba(0, 0, 0, 0.2);
        }
    </style>

    </style>
    <!-- bootstrap css -->
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <!-- style css -->
    <link rel="stylesheet" href="css/style.css">
    <!-- Responsive-->
    <link rel="stylesheet" href="css/responsive.css">
    <!-- fevicon -->
    <link rel="icon" href="images/fevicon.png" type="image/gif" />
    <!-- Scrollbar Custom CSS -->
    <link rel="stylesheet" href="css/jquery.mCustomScrollbar.min.css">
    <!-- Tweaks for older IEs-->
    <link rel="stylesheet" href="https://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/fancybox/2.1.5/jquery.fancybox.min.css"
        media="screen">
    <!--[if lt IE 9]>
    <script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
    <script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script><![endif]-->
</head>

<body>
    <!-- loader  -->
    <div class="loader_bg">
        <div class="loader"><img src="images/loading.gif" alt="#" /></div>
    </div>
    <!-- end loader -->
    <div id="mySidepanel" class="sidepanel">
        <a href="javascript:void(0)" class="closebtn" onclick="closeNav()">×</a>
        <a href="index.html">Inicio</a>
        <a href="productos.html">Productos</a>
        <a href="agregar.html">Agregar productos</a>
        <a onclick="logout()" href="index.html">Cerrar sesión</a>
    </div>

    <header class="background-container"
        style="background: url('images/banner.png') no-repeat center center; background-size: cover; min-height: 100vh; position: relative;">
        <!-- header inner -->
        <div class="header">
            <div class="container-fluid">
                <div class="row align-items-center">
                    <div class="col-md-4 col-sm-4">
                        <div class="logo">
                            <a href="index.html"><img src="images/logo.png" alt="#" /></a>
                        </div>
                    </div>
                    <div class="col-md-8 col-sm-8 text-end">
                        <div class="right_bottun">
                            <button class="openbtn" onclick="openNav()"><img src="images/menu_icon.png"
                                    alt="#" /></button>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Formulario sobre el fondo -->
        <section class="form-container"
            style="position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); width: 100%; max-width: 600px; padding: 20px;">
            <div class="card shadow">
                <div class="card-body">
                    <h2 class="text-center mb-4">Agregar Nuevo Producto</h2>
                    <form id="agregarForm">
                        <div class="mb-3">
                            <label class="form-label">Nombre del Producto</label>
                            <input name="nombre" type="text" class="form-control" id="nombre"
                                placeholder="Ejemplo: Tarjeta Gráfica RTX 3080" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Descripción</label>
                            <textarea name="descripcion" class="form-control" id="descripcion" rows="3"
                                placeholder="Ejemplo: Potente tarjeta gráfica para gaming y diseño 3D"
                                required></textarea>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Precio</label>
                            <input name="precio" type="number" class="form-control" id="precio"
                                placeholder="Ejemplo: 15000" required>
                        </div>
                        <div class="mb-3">
                            <label class="form-label">Imagen del producto</label>
                            <input name="imagen" type="file" class="form-control" id="imagen" required>
                        </div>
                        <div class="text-center">
                            <button type="submit" class="btn btn-primary w-100">Agregar Producto</button>
                        </div>
                    </form>
                </div>
            </div>
        </section>
    </header>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0-alpha1/dist/js/bootstrap.bundle.min.js"></script>
    <!-- end footer -->
    <!-- Javascript files-->
    <script src="js/jquery.min.js"></script>
    <script src="js/popper.min.js"></script>
    <script src="js/jquery-3.0.0.min.js"></script>
    <!-- sidebar -->
    <script src="js/jquery.mCustomScrollbar.concat.min.js"></script>
    <script src="js/custom.js"></script>
    <script>
        function openNav() {
            document.getElementById("mySidepanel").style.width = "250px";
        }

        function closeNav() {
            document.getElementById("mySidepanel").style.width = "0";
        }
    </script>

    <!-- script registro de productos -->
    <script>
        document.getElementById('agregarForm').addEventListener('submit', async (e) => {
    e.preventDefault(); // Previene la recarga de la página

    // Obtener los datos del formulario
    const formData = new FormData(e.target);

    try {
        const response = await fetch('http://localhost:3000/agregar', {
            method: 'POST',
            body: formData, // Enviar FormData en lugar de JSON
        });

        if (response.ok) {
            alert('Producto agregado exitosamente');
            e.target.reset();
        } else {
            const error = await response.text();
            alert('Error: ' + error);
        }
    } catch (err) {
        console.error('Error al intentar agregar producto:', err);
        alert('Ocurrió un problema al agregar el producto.');
    }
});


    </script>
</body>

</html>